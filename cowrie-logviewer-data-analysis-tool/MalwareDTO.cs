using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Http;
using System.Text;
using System.Threading.Tasks;
using static cowrie_logviewer_data_analysis_tool.MalwareDTO;

namespace cowrie_logviewer_data_analysis_tool
{
    class MalwareDTO
    {
        public Data data { get; set; }

        public class Data {
            public Attributes attributes { get; set; }
            public string id { get; set; }
            public string type { get; set; }
        }
        public class Attributes {
            public EngineResults last_analysis_results { get; set; }
            public int times_submitted { get; set; }
            public ExifTool exiftool { get; set; }
            public LAS last_analysis_stats { get; set; }

            public long first_submission_date { get; set; }
            public long last_analysis_date { get; set; }
            
                
            public long last_modification_date { get; set; }
            public long last_submission_date { get; set; }
            public string magic { get; set; }
            public string[] names { get; set; }
            public int reputation { get; set; }
            public long size { get; set; }
            public string[] tags { get; set; }
            public string type_tag { get; set; }
            public string type_description { get; set; }
            public long unique_sources { get; set; }
            public string meaningful_name { get; set; }

        }
        public class LAS
        {
            public int failure { get; set; }
            public int harmless { get; set; }
            public int malicious { get; set; }
            public int suspicious { get; set; }
            public int timeout { get; set; }
            public int undetected { get; set; }
        }

        public class ExifTool
        {
            public string FileTypeExtension { get; set; }
            public int LineCount { get; set; }
            public string MIMEEncoding { get; set; }
            public string MIMEType { get; set; }
            public string Newlines { get; set; }
            public int WordCount { get; set; }
            public string ModifyDate { get; set; }
        }

        public List<EngineResult> engineResults(EngineResults er) {
            return er.GetType().GetProperties().Select(p => (EngineResult)p.GetValue(er)).ToList();
        }

        public class EngineResults
        {
            public EngineResult ALYac { get; set; }
            public EngineResult APEX { get; set; }
            public EngineResult AVG { get; set; }
            public EngineResult Acronis { get; set; }
            public EngineResult AegisLab { get; set; }
            public EngineResult Alibaba { get; set; }
            public EngineResult Arcabit { get; set; }
            public EngineResult Avast { get; set; }
            public EngineResult Avira { get; set; }
            public EngineResult Baidu { get; set; }
            public EngineResult Bkav { get; set; }
            public EngineResult BitDefenderTheta { get; set; }
            public EngineResult BitDefender { get; set; }
            public EngineResult CMC { get; set; }
            public EngineResult ClamAV { get; set; }
            public EngineResult Comodo { get; set; }
            public EngineResult CrowdStrike { get; set; }
            public EngineResult Cybereason { get; set; }
            public EngineResult Cylance { get; set; }
            public EngineResult Cyren { get; set; }
            public EngineResult DrWeb { get; set; }
            public EngineResult Emsisoft { get; set; }
            public EngineResult Endgame { get; set; }
            public EngineResult Fortinet { get; set; }
            public EngineResult FireEye { get; set; }
            public EngineResult Microsoft { get; set; }
            public EngineResult McAfee { get; set; }
            public EngineResult MaxSecure { get; set; }
            public EngineResult Malwarebytes { get; set; }
            public EngineResult MAX { get; set; }
            public EngineResult Kingsoft { get; set; }
            public EngineResult Kaspersky { get; set; }
            public EngineResult GData { get; set; }
            public EngineResult Ikarus { get; set; }
            public EngineResult Invincea { get; set; }
            public EngineResult Jiangmin { get; set; }
            public EngineResult K7AntiVirus { get; set; }
            public EngineResult K7GW { get; set; }
            public EngineResult Paloalto { get; set; }
            public EngineResult Panda { get; set; }
            public EngineResult Rising { get; set; }
            public EngineResult SUPERAntiSpyware { get; set; }
            public EngineResult Sangfor { get; set; }
            public EngineResult SentinelOne { get; set; }
            public EngineResult Sophos { get; set; }
            public EngineResult SymantecMobileInsight { get; set; }
            public EngineResult TACHYON { get; set; }
            public EngineResult Tencent { get; set; }
            public EngineResult TotalDefense { get; set; }
            public EngineResult Trapmine { get; set; }
            public EngineResult Trustlook { get; set; }
            public EngineResult VBA32 { get; set; }
            public EngineResult VIPRE { get; set; }
            public EngineResult ViRobot { get; set; }
            public EngineResult Webroot { get; set; }
            public EngineResult Zillya { get; set; }
            public EngineResult ZoneAlarm { get; set; }
            public EngineResult Zoner { get; set; }
            public EngineResult eGambit { get; set; }
            public EngineResult Symantec { get; set; }
            public EngineResult TrendMicro { get; set; }
            public EngineResult Yandex { get; set; }
        }

        public class EngineResult
        {
            public string category { get; set; }
            public string engine_name { get; set; }
            public string engine_update { get; set; }
            public string engine_version { get; set; }
            public string method { get; set; }
            public string result { get; set; }
        }
    }
}
